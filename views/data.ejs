<!DOCTYPE html>
<html>
<head>

  <script type="text/javascript-lazy">
  function dataTest(data,formTime,nameX,nameY){

    var durationInMinutes = 0;
    switch(formTime) {
      case "1":
      durationInMinutes = 6*60;
      break;
      case "2":
      durationInMinutes = 24*60;
      break;
      case "3":
      durationInMinutes = 24*3*60;
      break;
      case "4":
      durationInMinutes = 24*7*60;
      break;
      case "5":
      durationInMinutes = 24*7*2*60;
      break;
      case "6":
      durationInMinutes = 24*30*60;
      break;
      case "7":
      durationInMinutes = 24*30*2*60;
      break;
    }
    var MS_PER_MINUTE = 60000;
    var date = new Date();
    var myStartDate = (date - durationInMinutes * MS_PER_MINUTE);
    var url = "http://localhost:8080/data";
    var dataTry = httpGet(url);
    console.log(JSON.parse(dataTry));
    var dataSort = [[nameX,nameY]];

  };


  function httpGet(theUrl)
  {
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
    xmlHttp.send( null );
    return xmlHttp.responseText;
  }
  </script>
  <script type="text/javascript-lazy" src = "/graphs.js"></script>
  <script type="text/javascript-lazy">
  $("dataPart").hide();
  </script>
</head>
<body>



  <form class="form-inline" >

   <br>
   <div class="form-group">
     Choose factors to plot against each other on the x- and y-axis.
     <br>
     <label for="xaxis">X-axis: </label>
     <select class="form-control" name="stringX">
      <option value="Time">Time</option>
      <option value = "Temperature">Temperature</option>
      <option value = "Light">Light</option>
      <option value = "pH">pH</option>
    </select>
    and
    <label for="yaxis">Y-axis: </label>
    <select class="form-control" name="stringY">
      <option value="Time">Time</option>
      <option value = "Temperature">Temperature</option>
      <option value = "Light">Light</option>
      <option value = "pH">pH</option>
    </select>
    <br>
    Use data from:
    <select class="form-control" name="timeSpan">
      <option value="1">the past 6 hours</option>
      <option value="2">the past day</option>
      <option value="3">the past 3 days</option>
      <option value="4">the past week</option>
      <option value="5">the past 2 weeks</option>
      <option value="6">the past month</option>
      <option value="7">the past 2 months</option>
    </select>

  </div>
  <br>
  <input  type="text" value=<%= data %> name="testText">
  <dataPart class = "invisible">
    <%= data %>
  </dataPart>
  <button id="render-chart" onclick="dataTest($('dataPart').text(),this.form.timeSpan.value,this.form.stringY.value,this.form.stringX.value)">Render Graph</button>
  <button id="render-chart" onclick="testFunction(<%= data %>)">testFunction</button>
</form>


</div>
<br><br>
<div id="chart_div"></div>
<button id="testButton">Data</button>

<br>
<div class="container">
  <h2>Recent Data Values</h2>
  <div class="table-responsive">
    <table class="table">
      <thead>
        <tr>
          <th>Time</th>
          <th>Temperature</th>
          <th>Light</th>
          <th>pH</th>
        </tr>
      </thead>
      <tbody>
        <% var index = Math.min(20, data.length); %>
        <% for(var i = 0; i < index; i++) { %>
        <tr>
          <td>
            <%= data[i].date %>
          </td>
          <td>
            <%= data[i].temp %>
          </td>
          <td>
            <%= data[i].light %>
          </td>
          <td>
            <%= data[i].pH %>
          </td>
        </tr>
        <% } %>
      </tbody>
    </table>
    <p>

    </p>
  </div>
</div>

</body>
</html>
